SELECT
    CAST([date] AS date) AS price_date,
    ROUND(CAST(market_price_usd AS float), 2) AS market_price_usd,
    ROUND(
        AVG(CAST(market_price_usd AS float)) OVER (
            ORDER BY CAST([date] AS date)
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ), 
        2
    ) AS avg_price_7d
FROM market_prices_large
ORDER BY price_date;

price_date	market_price_usd	avg_price_7d
2023-10-02	82.3	82.3
2023-10-03	82.22	82.26
2023-10-04	82.6	82.37
2023-10-05	83.52	82.66
2023-10-06	83.38	82.8
2023-10-09	83.24	82.88
2023-10-10	84.18	83.06
2023-10-11	84.64	83.4
2023-10-12	84.36	83.7
2023-10-13	84.69	84
2023-10-16	84.41	84.13
2023-10-17	84.13	84.24
2023-10-18	84.28	84.38
2023-10-19	83.13	84.23
2023-10-20	82.09	83.87
2023-10-23	81.76	83.5
2023-10-24	81.15	82.99
2023-10-25	81.34	82.55
2023-10-26	80.79	82.08
2023-10-27	79.94	81.46
2023-10-30	80.82	81.13
2023-10-31	80.69	80.93
2023-11-01	80.73	80.78
2023-11-02	79.87	80.6
2023-11-03	79.55	80.34
2023-11-06	79.61	80.17
2023-11-07	78.92	80.03
2023-11-08	79.15	79.79
2023-11-09	78.79	79.52
2023-11-10	78.61	79.21
2023-11-13	78.25	78.98
2023-11-14	79.36	78.96
2023-11-15	79.36	78.92
2023-11-16	78.72	78.89
2023-11-17	79.21	78.9
2023-11-20	78.48	78.86
2023-11-21	78.61	78.86
2023-11-22	77.43	78.74
2023-11-23	76.63	78.35
2023-11-24	76.75	77.98
2023-11-27	77.2	77.76
2023-11-28	77.3	77.49
2023-11-29	77.23	77.31
2023-11-30	77.05	77.08
2023-12-01	76.16	76.9
2023-12-04	75.73	76.77
2023-12-05	75.45	76.59
2023-12-06	76.09	76.43
2023-12-07	76.29	76.29
2023-12-08	75.24	76
2023-12-11	75.43	75.77
2023-12-12	75.2	75.63
2023-12-13	74.79	75.5
2023-12-14	75.16	75.46
2023-12-15	75.78	75.41
2023-12-18	76.34	75.42
2023-12-19	75.83	75.5
2023-12-20	75.65	75.54
2023-12-21	75.85	75.63
2023-12-22	76.43	75.86
2023-12-25	76.14	76
2023-12-26	76.03	76.04
2023-12-27	75.37	75.9
2023-12-28	74.65	75.73
2023-12-29	75.14	75.66
2024-01-01	75.95	75.67
2024-01-02	75.91	75.6
2024-01-03	76.51	75.65
2024-01-04	76.73	75.75
2024-01-05	76.34	75.89
2024-01-08	76.56	76.16
2024-01-09	77.48	76.5
2024-01-10	77.46	76.71
2024-01-11	78.4	77.07
2024-01-12	76.83	77.11
2024-01-15	77.32	77.2
2024-01-16	77.37	77.35
2024-01-17	77.19	77.44
2024-01-18	77.25	77.4
2024-01-19	76.06	77.2
2024-01-22	75.92	76.85
2024-01-23	76.14	76.75
2024-01-24	77.02	76.71
2024-01-25	76.71	76.61
2024-01-26	76.23	76.48
2024-01-29	75.93	76.29
2024-01-30	76.48	76.35
2024-01-31	76.67	76.45
2024-02-01	76.36	76.49
2024-02-02	76.66	76.43
2024-02-05	76.72	76.44
2024-02-06	77.3	76.59
2024-02-07	76.88	76.72
2024-02-08	76.69	76.75
2024-02-09	76.45	76.72
2024-02-12	75.57	76.61
2024-02-13	75.75	76.48
2024-02-14	75.91	76.36
2024-02-15	75.91	76.17
2024-02-16	75.77	76.01
2024-02-19	74.92	75.75
2024-02-20	74.67	75.5
2024-02-21	74.46	75.34
2024-02-22	73.98	75.09
2024-02-23	73.88	74.8
2024-02-26	74.13	74.54
2024-02-27	75.26	74.47
2024-02-28	75.36	74.53
2024-02-29	75.52	74.66
2024-03-01	75.47	74.8
2024-03-04	74.32	74.85
2024-03-05	74.31	74.91
2024-03-06	74.34	74.94
2024-03-07	75.82	75.02
2024-03-08	75.7	75.07
2024-03-11	75.89	75.12
2024-03-12	75.86	75.18
2024-03-13	75.16	75.3
2024-03-14	75.85	75.52
2024-03-15	76.3	75.8
2024-03-18	76.77	75.93
2024-03-19	76.23	76.01
2024-03-20	77.07	76.18
2024-03-21	76.23	76.23
2024-03-22	76.58	76.43
2024-03-25	77.9	76.73
2024-03-26	77.3	76.87
2024-03-27	76.96	76.9
2024-03-28	77.02	77.01
2024-03-29	76.72	76.96

