SELECT
    CAST(t.trade_date AS date) AS trade_date,
    ROUND(
        SUM(
            CASE 
                WHEN t.buy_sell = 'Buy'
                THEN (CAST(p.market_price_usd AS float) - CAST(t.trade_price_usd AS float)) * t.volume_barrels
                ELSE (CAST(t.trade_price_usd AS float) - CAST(p.market_price_usd AS float)) * t.volume_barrels
            END
        ),
        2
    ) AS total_daily_value_impact_usd
FROM trades_large t
JOIN market_prices_large p
    ON CAST(t.trade_date AS date) = CAST(p.[date] AS date)
GROUP BY CAST(t.trade_date AS date)
ORDER BY trade_date;


O/P

trade_date	total_daily_value_impact_usd
2023-10-03	-71379
2023-10-05	-340693.6
2023-10-09	-544419.4
2023-10-10	129730.14
2023-10-11	-966216.02
2023-10-12	534397.76
2023-10-16	-1134821.2
2023-10-18	929902.75
2023-10-20	870278.98
2023-10-24	-925414.21
2023-10-25	-411372.88
2023-10-27	-444709.76
2023-10-30	522198.81
2023-10-31	-261067.3
2023-11-02	-405793.58
2023-11-03	172727.28
2023-11-06	-137199.15
2023-11-07	-312530.06
2023-11-08	1524338.15
2023-11-10	-973228.8
2023-11-14	-814957.8
2023-11-15	-104858.98
2023-11-17	33885.68
2023-11-20	875732.9
2023-11-21	727665.35
2023-11-22	-208647.4
2023-11-23	618489.53
2023-11-28	2462260.85
2023-11-29	1008260.68
2023-12-04	2531294.64
2023-12-06	-1598230.17
2023-12-07	-448737
2023-12-08	1912791.78
2023-12-11	-1598870.9
2023-12-12	200106.9
2023-12-14	-2587438.29
2023-12-19	-1023999.6
2023-12-20	1556428.46
2023-12-22	-608285.68
2023-12-25	-628222.68
2023-12-27	-462670.76
2023-12-29	111799.74
2024-01-01	-889502.88
2024-01-02	-1492330.76
2024-01-03	-566233.92
2024-01-05	1177003.52
2024-01-12	-512056.06
2024-01-23	-2766168.48
2024-01-25	2447865
2024-01-29	1006173.3
2024-02-02	66355.59
2024-02-06	202365.08
2024-02-07	3393204
2024-02-09	1415519.52
2024-02-12	-125086.5
2024-02-13	-1349970.75
2024-02-14	-815898.6
2024-02-15	-3102444.37
2024-02-22	1467967.9
2024-02-29	-276678.72
2024-03-01	2402781.58
2024-03-04	-2084949.44
2024-03-05	1509869.14
2024-03-06	-2118801.2
2024-03-07	-1837643.21
2024-03-08	-1146076.15
2024-03-11	-1396654.68
2024-03-12	854943.6
2024-03-14	-1356874.74
2024-03-15	540465.84
2024-03-21	124512.69
2024-03-22	-1645766.65
2024-03-26	-724627.2
2024-03-27	-2825565.19
2024-03-28	-492202.95
2024-03-29	8291.8
